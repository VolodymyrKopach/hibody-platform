# –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É—Ä–æ–∫—ñ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–∏—Ö

## –ü—Ä–æ–±–ª–µ–º–∞
–î—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ–π –ø—Ä–∞—Ü—é–≤–∞–≤, –∞–ª–µ –∑–±–µ—Ä—ñ–≥–∞–≤ –¥–∞–Ω—ñ –≤ localStorage –∑–∞–º—ñ—Å—Ç—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö Supabase.

## –†—ñ—à–µ–Ω–Ω—è
–ú–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é `saveSelectedSlides` –≤ `src/hooks/useSlideManagement.ts` –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API –∑–∞–º—ñ—Å—Ç—å localStorage.

## –ó–º—ñ–Ω–∏

### 1. –û–Ω–æ–≤–ª–µ–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
**–§–∞–π–ª:** `src/hooks/useSlideManagement.ts`

**–ë—É–ª–æ:**
```typescript
// –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ localStorage
const success = LessonStorage.saveLesson(newLesson);
```

**–°—Ç–∞–ª–æ:**
```typescript
// –°—Ç–≤–æ—Ä—é—î–º–æ —É—Ä–æ–∫ —á–µ—Ä–µ–∑ API (–±–∞–∑–∞ –¥–∞–Ω–∏—Ö)
const lessonResponse = await fetch('/api/lessons', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    title: dialogData.title.trim(),
    description: dialogData.description.trim(),
    subject: dialogData.subject.trim(),
    targetAge: dialogData.ageGroup.trim(),
    duration: slideUIState.currentLesson.duration,
    slides: selectedSlides.map((slide, index) => ({
      title: slide.title,
      description: slide.content,
      htmlContent: slide.htmlContent,
      type: slide.type,
      slideNumber: index + 1
    }))
  })
});
```

### 2. –í–∏–¥–∞–ª–µ–Ω–æ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ localStorage
–í–∏–¥–∞–ª–µ–Ω–æ —ñ–º–ø–æ—Ä—Ç–∏:
- `LessonStorage` 
- `SavedLesson`

### 3. –û–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö
```typescript
text: `‚úÖ **–£—Ä–æ–∫ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ –±–∞–∑—É –¥–∞–Ω–∏—Ö!**\n\nüìö **"${dialogData.title}"** —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ –¥–æ –≤–∞—à–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤.\n\nüìä **–ó–±–µ—Ä–µ–∂–µ–Ω–æ —Å–ª–∞–π–¥—ñ–≤:** ${selectedSlides.length}\n\nüéØ –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —É—Ä–æ–∫ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [–ú–æ—ó –º–∞—Ç–µ—Ä—ñ–∞–ª–∏](/materials).`
```

## API –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

### Endpoint: POST /api/lessons
–Ü—Å–Ω—É—é—á–∏–π API –º–∞—Ä—à—Ä—É—Ç –ø—ñ–¥—Ç—Ä–∏–º—É—î:
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —É—Ä–æ–∫—ñ–≤ –∑ –º–µ—Ç–∞–¥–∞–Ω–∏–º–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ª–∞–π–¥—ñ–≤
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è HTML –∫–æ–Ω—Ç–µ–Ω—Ç—É —Å–ª–∞–π–¥—ñ–≤
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—é –¥–∞–Ω–∏—Ö
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Ç—É:
```typescript
interface CreateLessonRequest {
  title: string;
  description: string;
  targetAge: string;
  subject: string;
  duration: number;
  slides?: Array<{
    title: string;
    description?: string;
    htmlContent?: string;
    type?: string;
    slideNumber?: number;
  }>;
}
```

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –°—Ç–≤–æ—Ä–µ–Ω–æ —Ç–µ—Å—Ç-—Å–∫—Ä–∏–ø—Ç
**–§–∞–π–ª:** `scripts/test-lesson-saving.js`

**–ó–∞–ø—É—Å–∫:**
```bash
npm run test:lesson-saving
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
- ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –ø—Ä–∞—Ü—é—î
- ‚úÖ API –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–º–∞–≥–∞—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Ç—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –æ—á—ñ–∫—É–≤–∞–Ω—ñ–π

## –ü–æ–≤–µ–¥—ñ–Ω–∫–∞

### –†–∞–Ω—ñ—à–µ (localStorage):
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±–∏—Ä–∞—î —Å–ª–∞–π–¥–∏
2. –í—ñ–¥–∫—Ä–∏–≤–∞—î –¥—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
3. –ó–∞–ø–æ–≤–Ω—é—î —Ñ–æ—Ä–º—É
4. –£—Ä–æ–∫ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ localStorage
5. –£—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏–π —Ç—ñ–ª—å–∫–∏ –Ω–∞ —Ü—å–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó

### –¢–µ–ø–µ—Ä (–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö):
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±–∏—Ä–∞—î —Å–ª–∞–π–¥–∏
2. –í—ñ–¥–∫—Ä–∏–≤–∞—î –¥—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
3. –ó–∞–ø–æ–≤–Ω—é—î —Ñ–æ—Ä–º—É
4. **–£—Ä–æ–∫ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–∏—Ö Supabase**
5. **–£—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ –≤—Å—ñ—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**
6. **–£—Ä–æ–∫ –º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö**

## –ü–µ—Ä–µ–≤–∞–≥–∏
- üîÑ **–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è** –º—ñ–∂ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏
- üíæ **–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å** –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
- üë• **–ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Å–ø—ñ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É**
- üìä **–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞** —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üîç **–ü–æ—à—É–∫** —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è
- üè∑Ô∏è **–¢–µ–≥–∏** —Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó

## –ë–µ–∑–ø–µ–∫–∞
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –æ–±–æ–≤'—è–∑–∫–æ–≤–∞
- ‚úÖ RLS (Row Level Security) –ø–æ–ª—ñ—Ç–∏–∫–∏
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
- ‚úÖ –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ SQL —ñ–Ω'—î–∫—Ü—ñ–π

## –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å
- ‚úÖ –Ü—Å–Ω—É—é—á—ñ —É—Ä–æ–∫–∏ –≤ localStorage –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è
- ‚úÖ –ú—ñ–≥—Ä–∞—Ü—ñ—è –∑ localStorage –º–æ–∂–ª–∏–≤–∞ —á–µ—Ä–µ–∑ `LocalStorageMigrationService`
- ‚úÖ –ó–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ API

## –°—Ç–∞—Ç—É—Å
- ‚úÖ **–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ** - –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –±–∞–∑—É –¥–∞–Ω–∏—Ö
- ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ** - API –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è** - –ü–æ—Ç—Ä–µ–±—É—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏
1. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤ UI –∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º
2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —É—Ä–æ–∫—ñ–≤ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ "–ú–æ—ó –º–∞—Ç–µ—Ä—ñ–∞–ª–∏"
3. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ—ó –∑ localStorage (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ) 