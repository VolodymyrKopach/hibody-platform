# üìä Database Information Collection

## üéØ –ú–µ—Ç–∞

–¶—ñ —Å–∫—Ä–∏–ø—Ç–∏ –∑–±–∏—Ä–∞—é—Ç—å –ø–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î –¥–ª—è:
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –º—ñ–≥—Ä–∞—Ü—ñ–π
- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—ó TypeScript —Ç–∏–ø—ñ–≤
- –†–æ–∑—É–º—ñ–Ω–Ω—è –∑–≤'—è–∑–∫—ñ–≤ –º—ñ–∂ —Ç–∞–±–ª–∏—Ü—è–º–∏
- –†–æ–±–æ—Ç–∏ –∑ AI –ø–æ–º—ñ—á–Ω–∏–∫–∞–º–∏

---

## üöÄ –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

```bash
# –ó—Ä–æ–±–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–º
chmod +x scripts/export-db-structure.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –µ–∫—Å–ø–æ—Ä—Ç
bash scripts/export-db-structure.sh
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ `db-structure.json` - JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î
- ‚úÖ `db-structure.txt` - —Ç–µ–∫—Å—Ç–æ–≤–∏–π –æ–ø–∏—Å
- ‚úÖ `db-schema.sql` - –ø–æ–≤–Ω–∞ SQL —Å—Ö–µ–º–∞

---

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É —á–µ—Ä–µ–∑ Supabase Dashboard

#### 1. JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ SQL Editor –≤ Supabase
2. –í—Å—Ç–∞–≤–∏—Ç–∏ –≤–º—ñ—Å—Ç `scripts/collect-db-info-json.sql`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏
4. –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –∑–±–µ—Ä–µ–≥—Ç–∏ —è–∫ `db-structure.json`

#### 2. –¢–µ–∫—Å—Ç–æ–≤–∏–π –æ–ø–∏—Å:
1. –í—Å—Ç–∞–≤–∏—Ç–∏ –≤–º—ñ—Å—Ç `scripts/collect-db-info.sql`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–∏
3. –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –∑–±–µ—Ä–µ–≥—Ç–∏ —è–∫ `db-structure.txt`

---

### –í–∞—Ä—ñ–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Supabase CLI

```bash
# JSON
supabase db execute --file scripts/collect-db-info-json.sql > db-structure.json

# Text
supabase db execute --file scripts/collect-db-info.sql > db-structure.txt

# Full schema
supabase db dump --schema public > db-schema.sql
```

---

## üìã –©–æ –∑–±–∏—Ä–∞—î—Ç—å—Å—è

### 1. **Tables** - —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö —Ç–∞–±–ª–∏—Ü—å
### 2. **Columns** - –≤—Å—ñ –∫–æ–ª–æ–Ω–∫–∏ (—Ç–∏–ø, nullable, default)
### 3. **Foreign Keys** - –∑–≤'—è–∑–∫–∏ –º—ñ–∂ —Ç–∞–±–ª–∏—Ü—è–º–∏
### 4. **Unique Constraints** - —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è
### 5. **Indexes** - –≤—Å—ñ —ñ–Ω–¥–µ–∫—Å–∏
### 6. **Functions** - SQL —Ñ—É–Ω–∫—Ü—ñ—ó
### 7. **Triggers** - —Ç—Ä–∏–≥–µ—Ä–∏
### 8. **RLS Policies** - –ø–æ–ª—ñ—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏
### 9. **Table Sizes** - —Ä–æ–∑–º—ñ—Ä —Ç–∞–±–ª–∏—Ü—å
### 10. **Enums** - enum —Ç–∏–ø–∏

---

## ü§ñ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ AI

–ö–æ–ª–∏ –ø—Ä–∞—Ü—é—î—à –∑ AI –ø–æ–º—ñ—á–Ω–∏–∫–æ–º (ChatGPT, Claude, etc.):

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –µ–∫—Å–ø–æ—Ä—Ç:**
```bash
bash scripts/export-db-structure.sh
```

2. **–í—ñ–¥–∫—Ä–∏—Ç–∏ `db-structure.json`**

3. **–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —ñ –Ω–∞–¥–∞—Ç–∏ AI:**
```
–û—Å—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ—î—ó –ë–î:

[–≤—Å—Ç–∞–≤–∏—Ç–∏ –≤–º—ñ—Å—Ç db-structure.json]

–¢–µ–ø–µ—Ä —Å—Ç–≤–æ—Ä–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é –¥–ª—è...
```

---

## üìä –§–æ—Ä–º–∞—Ç JSON

```json
{
  "tables": {
    "users": {
      "columns": {
        "id": {
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        ...
      },
      "foreign_keys": [...],
      "indexes": [...],
      "rls_enabled": true
    }
  },
  "functions": [...],
  "triggers": [...],
  "policies": [...]
}
```

---

## ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

–ü—ñ—Å–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É –ø–µ—Ä–µ–≤—ñ—Ä:

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏—Å—å —Ñ–∞–π–ª–∏
ls -lh db-structure.*

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä
wc -l db-structure.txt

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ JSON
cat db-structure.json | jq .
```

---

## üîÑ –ö–æ–ª–∏ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏

–ó–∞–ø—É—Å–∫–∞–π –µ–∫—Å–ø–æ—Ä—Ç –ø—ñ—Å–ª—è:
- –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –º—ñ–≥—Ä–∞—Ü—ñ–π
- –ó–º—ñ–Ω–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ë–î
- –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ç–∞–±–ª–∏—Ü—å/–∫–æ–ª–æ–Ω–æ–∫
- –ó–º—ñ–Ω–∏ RLS policies

---

## üí° –ü–æ—Ä–∞–¥–∏

1. **–î–æ–¥–∞–π –¥–æ .gitignore:**
```
db-structure.json
db-structure.txt
db-schema.sql
```

2. **–°—Ç–≤–æ—Ä–∏ alias:**
```bash
# –í ~/.zshrc –∞–±–æ ~/.bashrc
alias dbexport="bash scripts/export-db-structure.sh"
```

3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑—É–π:**
```bash
# –ü—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –º—ñ–≥—Ä–∞—Ü—ñ—ó
supabase db push && bash scripts/export-db-structure.sh
```

---

## üìù –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

**–ó–∞–¥–∞—á–∞:** –°—Ç–≤–æ—Ä–∏—Ç–∏ API –¥–ª—è finance analytics

**–ö—Ä–æ–∫ 1:** –ó—ñ–±—Ä–∞—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î
```bash
bash scripts/export-db-structure.sh
```

**–ö—Ä–æ–∫ 2:** –ù–∞–¥–∞—Ç–∏ AI –∫–æ–Ω—Ç–µ–∫—Å—Ç
```
–ú–∞—é —Ç–∞–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î: [db-structure.json]

–°—Ç–≤–æ—Ä–∏ API endpoint –¥–ª—è revenue metrics —è–∫–∏–π:
- –†–∞—Ö—É—î MRR –∑ payments —Ç–∞–±–ª–∏—Ü—ñ
- –ì—Ä—É–ø—É—î –ø–æ subscription_type
- –ü–æ–≤–µ—Ä—Ç–∞—î trends –∑–∞ 30 –¥–Ω—ñ–≤
```

**–ö—Ä–æ–∫ 3:** AI —Å—Ç–≤–æ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–æ–¥ –±–æ –∑–Ω–∞—î:
- –Ø–∫—ñ —Ç–∞–±–ª–∏—Ü—ñ —ñ—Å–Ω—É—é—Ç—å
- –Ø–∫—ñ –∫–æ–ª–æ–Ω–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ
- –Ø–∫—ñ –∑–≤'—è–∑–∫–∏ –º—ñ–∂ —Ç–∞–±–ª–∏—Ü—è–º–∏
- –Ø–∫—ñ —î indexes –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä AI –º–æ–∂–µ:
- ‚úÖ –°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –º—ñ–≥—Ä–∞—Ü—ñ—ó
- ‚úÖ –ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ç–∏–ø–∏ TypeScript
- ‚úÖ –ü–∏—Å–∞—Ç–∏ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏
- ‚úÖ –ü—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ indexes
- ‚úÖ –í—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —ñ—Å–Ω—É—é—á—ñ –∑–≤'—è–∑–∫–∏

**–ë–µ–∑ –ø–æ–º–∏–ª–æ–∫ —Ç–∏–ø—É:**
- ‚ùå "table doesn't exist"
- ‚ùå "column not found"
- ‚ùå "foreign key violation"

