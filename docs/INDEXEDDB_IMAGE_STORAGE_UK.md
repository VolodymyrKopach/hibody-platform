# IndexedDB –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å

## üéØ –í–∏—Ä—ñ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞

–†–∞–Ω—ñ—à–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞–ª–∏—Å—è —è–∫ Base64 —Ä—è–¥–∫–∏ –≤ `localStorage`, —â–æ —Å–ø—Ä–∏—á–∏–Ω—è–ª–æ:
- ‚ùå **QuotaExceededError** - Base64 –Ω–∞ ~33% –±—ñ–ª—å—à–∏–π –∑–∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª
- ‚ùå **–ü—Ä–æ–±–ª–µ–º–∏ –∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é** - –í–µ–ª–∏–∫—ñ —Ä—è–¥–∫–∏ —Å–ø–æ–≤—ñ–ª—å–Ω—é—é—Ç—å —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é
- ‚ùå **–û–±–º–µ–∂–µ–Ω–Ω—è storage** - localStorage –æ–±–º–µ–∂–µ–Ω–∏–π ~5MB

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è: IndexedDB

### –ß–æ–º—É IndexedDB?

| –§—É–Ω–∫—Ü—ñ—è | localStorage | IndexedDB |
|---------|--------------|-----------|
| **–õ—ñ–º—ñ—Ç** | ~5MB | 50% –¥–∏—Å–∫–∞ (GB) |
| **–¢–∏–ø–∏ –¥–∞–Ω–∏—Ö** | –¢—ñ–ª—å–∫–∏ —Ä—è–¥–∫–∏ | Blob, File, –æ–±'—î–∫—Ç–∏ |
| **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å** | –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ |
| **Overhead** | Base64 (+33%) | –ë—ñ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ (0%) |
| **API** | –ü—Ä–æ—Å—Ç–∏–π | –°–∫–ª–∞–¥–Ω—ñ—à–∏–π |

### –ü—Ä–∏–∫–ª–∞–¥ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

**–¢–µ —Å–∞–º–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è 2MB:**
- localStorage (Base64): ~2.7MB —Ä—è–¥–æ–∫
- IndexedDB (Blob): 2MB –±—ñ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ

**–Ñ–º–Ω—ñ—Å—Ç—å:**
- localStorage: ~1-2 –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è
- IndexedDB: –°–æ—Ç–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω—å

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### 1. –£—Ç–∏–ª—ñ—Ç–∞ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è (`imageStorage.ts`)

```typescript
// –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
const imageId = await storeImage(blob, 'photo.jpg');
// –ü–æ–≤–µ—Ä—Ç–∞—î: "img_1696243200000_abc123"

// –û—Ç—Ä–∏–º–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
const blob = await getImage(imageId);

// –û—Ç—Ä–∏–º–∞—Ç–∏ Blob URL –¥–ª—è <img>
const blobUrl = await getImageURL(imageId);
// –ü–æ–≤–µ—Ä—Ç–∞—î: "blob:http://localhost:3000/abc-123-def"

// –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
await clearAllImages();
```

### 2. –û–Ω–æ–≤–ª–µ–Ω–∏–π LocalImageService

```typescript
// –°–¢–ê–†–ï: Base64 Data URL
{
  url: 'data:image/jpeg;base64,/9j/4AAQ...', // –í–µ–ª–∏—á–µ–∑–Ω–∏–π —Ä—è–¥–æ–∫
  fileName: 'photo.jpg',
  size: 2700000 // –†–æ–∑–º—ñ—Ä Base64
}

// –ù–û–í–ï: Blob URL + IndexedDB ID
{
  url: 'blob:http://localhost:3000/abc-123',  // –ú–∞–ª–µ–Ω—å–∫–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è
  imageId: 'img_1696243200000_abc123',        // IndexedDB ID
  fileName: 'photo.jpg',
  size: 2000000 // –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä
}
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è

–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è –ø—Ä–∏ –≤–∏—Ö–æ–¥—ñ –∑ canvas:

```typescript
// –ü—Ä–∏ —Ä–æ–∑–º–æ–Ω—Ç—É–≤–∞–Ω–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
useEffect(() => {
  return () => {
    clearAllWorksheets();
    await clearAllImages(); // –û—á–∏—Å—Ç–∏—Ç–∏ IndexedDB
  };
}, []);

// –ü—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ –≤—ñ–∫–Ω–∞
window.addEventListener('beforeunload', () => {
  clearAllImages();
});

// –ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ "–ù–∞–∑–∞–¥"
const handleBackClick = async () => {
  clearAllWorksheets();
  await clearAllImages();
  router.push('/');
};
```

## üìä –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –°—Ö–µ–º–∞ IndexedDB

```
–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö: worksheet_images
–í–µ—Ä—Å—ñ—è: 1

ObjectStore: images
  KeyPath: id
  –Ü–Ω–¥–µ–∫—Å–∏:
    - createdAt (–Ω–µ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π)

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Å—É:
{
  id: string,           // "img_1696243200000_abc123"
  blob: Blob,          // –ë—ñ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
  filename: string,     // "photo.jpg"
  mimeType: string,     // "image/jpeg"
  size: number,         // 2000000
  createdAt: number     // 1696243200000
}
```

### –ü–æ—Ç—ñ–∫ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è

```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
      ‚Üì
–°—Ç–∏—Å–Ω–µ–Ω–Ω—è —è–∫—â–æ > 500KB
      ‚Üì
–ó–±–µ—Ä–µ–≥—Ç–∏ Blob –≤ IndexedDB
      ‚Üì
–û—Ç—Ä–∏–º–∞—Ç–∏ IndexedDB ID
      ‚Üì
–°—Ç–≤–æ—Ä–∏—Ç–∏ Blob URL
      ‚Üì
–ü–æ–≤–µ—Ä–Ω—É—Ç–∏ URL + ID –¥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
      ‚Üì
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Blob URL –≤ <img src={url} />
```

### –°—Ç–∏—Å–Ω–µ–Ω–Ω—è

–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –±—ñ–ª—å—à—ñ –∑–∞ 500KB —Å—Ç–∏—Å–∫–∞—é—Ç—å—Å—è:

```typescript
if (file.size > 500 * 1024) {
  // –°—Ç–∏—Å–Ω—É—Ç–∏ —á–µ—Ä–µ–∑ canvas
  const compressedDataUrl = await compressImage(file, maxWidth);
  
  // –ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –Ω–∞–∑–∞–¥ —É Blob
  const response = await fetch(compressedDataUrl);
  const blob = await response.blob();
  
  // –ó–±–µ—Ä–µ–≥—Ç–∏ —Å—Ç–∏—Å–Ω—É—Ç–∏–π Blob
  await storeImage(blob, filename);
}
```

–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —è–∫–æ—Å—Ç—ñ:
- –§–∞–π–ª–∏ > 2MB: 70% —è–∫—ñ—Å—Ç—å
- –§–∞–π–ª–∏ < 2MB: 85% —è–∫—ñ—Å—Ç—å

## üé® –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ input

```typescript
import { localImageService } from '@/services/images/LocalImageService';

const handleFileChange = async (e: ChangeEvent<HTMLInputElement>) => {
  const file = e.target.files?.[0];
  if (!file) return;

  const result = await localImageService.uploadLocalImage(file, {
    compress: true,
    maxWidth: 1920
  });

  if (result.success) {
    // –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ result.url –≤ <img>
    setImageUrl(result.url);
    
    // –ó–±–µ—Ä–µ–≥—Ç–∏ result.imageId –¥–ª—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è
    setImageId(result.imageId);
  }
};
```

### –í—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è

```typescript
// Blob URLs –ø—Ä–∞—Ü—é—é—Ç—å —Ç–∞–∫ —Å–∞–º–æ —è–∫ –∑–≤–∏—á–∞–π–Ω—ñ URLs
<img src={imageUrl} alt="–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–µ" />
```

### –û—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É storage

```typescript
import { getStorageStats } from '@/utils/imageStorage';

const stats = await getStorageStats();
console.log(`${stats.count} –∑–æ–±—Ä–∞–∂–µ–Ω—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å ${stats.formattedSize}`);
// –ü—Ä–∏–∫–ª–∞–¥: "5 –∑–æ–±—Ä–∞–∂–µ–Ω—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å 12.4MB"
```

### –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è

```typescript
import { clearAllImages } from '@/utils/imageStorage';

await clearAllImages();
console.log('–í—Å—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ—á–∏—â–µ–Ω—ñ –∑ IndexedDB');
```

## üîÑ –ú—ñ–≥—Ä–∞—Ü—ñ—è –∑ Base64

### –ó–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å

–°–µ—Ä–≤—ñ—Å –ø—ñ–¥—Ç—Ä–∏–º—É—î –∑–≤–æ—Ä–æ—Ç–Ω—É —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å:

```typescript
// –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ URL —î Blob –∞–±–æ Base64
if (localImageService.isBlobUrl(url)) {
  // –°—É—á–∞—Å–Ω–µ: Blob URL –∑ IndexedDB
  console.log('–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è IndexedDB');
} else if (localImageService.isBase64DataUrl(url)) {
  // –°—Ç–∞—Ä–µ: Base64 Data URL
  console.log('–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å—Ç–∞—Ä–∏–π Base64 —Ñ–æ—Ä–º–∞—Ç');
}
```

### –®–ª—è—Ö –º—ñ–≥—Ä–∞—Ü—ñ—ó

1. **–°—Ç–∞—Ä—ñ worksheets** –∑ Base64 –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º–∏ –ø—Ä–æ–¥–æ–≤–∂—É—é—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏
2. **–ù–æ–≤—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å IndexedDB
3. **–ë–µ–∑ –≤—Ç—Ä–∞—Ç–∏ –¥–∞–Ω–∏—Ö** –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ—Ö–æ–¥—É

## üöÄ –ü–µ—Ä–µ–≤–∞–≥–∏

### –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

- ‚úÖ **–®–≤–∏–¥—à–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**: –ù–µ–º–∞—î Base64 encoding overhead
- ‚úÖ **–®–≤–∏–¥—à–µ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è**: –ë—ñ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ —à–≤–∏–¥—à—ñ –∑–∞ –ø–∞—Ä—Å–∏–Ω–≥ —Ä—è–¥–∫—ñ–≤
- ‚úÖ **–ú–µ–Ω—à–µ –ø–∞–º'—è—Ç—ñ**: Blob –æ–±'—î–∫—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à—ñ

### Storage

- ‚úÖ **–í 10-100 —Ä–∞–∑—ñ–≤ –±—ñ–ª—å—à–∞ —î–º–Ω—ñ—Å—Ç—å**: GB –∑–∞–º—ñ—Å—Ç—å MB
- ‚úÖ **–ë–µ–∑ quota errors**: –ù–∞–±–∞–≥–∞—Ç–æ –≤–∏—â—ñ –ª—ñ–º—ñ—Ç–∏
- ‚úÖ **–ö—Ä–∞—â–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è**: –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Å—Ç–∏—Å–Ω—É—Ç—ñ Blobs

### User Experience

- ‚úÖ **–ü–ª–∞–≤–Ω—ñ—à–µ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è**: –ë–µ–∑ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å –ø—Ä–æ storage
- ‚úÖ **–ë—ñ–ª—å—à–µ –∑–æ–±—Ä–∞–∂–µ–Ω—å**: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–µ—Å—è—Ç–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å
- ‚úÖ **–®–≤–∏–¥—à–∏–π –µ–∫—Å–ø–æ—Ä—Ç**: –ü—Ä—è–º–∏–π Blob ‚Üí PDF

## üîß API –î–æ–≤—ñ–¥–Ω–∏–∫

### imageStorage.ts

```typescript
// –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ IndexedDB
storeImage(blob: Blob, filename: string): Promise<string>

// –û—Ç—Ä–∏–º–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ IndexedDB
getImage(id: string): Promise<Blob | null>

// –û—Ç—Ä–∏–º–∞—Ç–∏ Blob URL –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
getImageURL(id: string): Promise<string | null>

// –í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
deleteImage(id: string): Promise<void>

// –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
getAllImages(): Promise<ImageRecord[]>

// –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
clearAllImages(): Promise<void>

// –û—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É storage
getStorageStats(): Promise<{
  count: number;
  totalSize: number;
  formattedSize: string;
}>

// –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—é –±–∞–∑—É –¥–∞–Ω–∏—Ö
deleteDatabase(): Promise<void>
```

### LocalImageService

```typescript
// –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (–∑–±–µ—Ä—ñ–≥–∞—î –≤ IndexedDB)
uploadLocalImage(
  file: File,
  options?: {
    compress?: boolean;
    maxWidth?: number;
  }
): Promise<LocalImageUploadResult>

// –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∏–ø–∏ URL
isBlobUrl(url: string): boolean
isBase64DataUrl(url: string): boolean

// –û—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É storage
estimateStorageUsage(): Promise<{
  imageCount: number;
  totalSize: number;
  formattedSize: string;
}>

// –û—á–∏—Å—Ç–∏—Ç–∏ storage
clearStorage(): Promise<void>
```

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –†—É—á–Ω–∏–π —Ç–µ—Å—Ç

1. –í—ñ–¥–∫—Ä–∏—Ç–∏ Canvas Editor
2. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –≤–µ–ª–∏–∫–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å (2-3MB –∫–æ–∂–Ω–µ)
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ–Ω—Å–æ–ª—å: "‚úÖ Image stored in IndexedDB"
4. –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è —â–æ –Ω–µ–º–∞—î QuotaExceededError
5. –ó–∞–∫—Ä–∏—Ç–∏ canvas - –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –º–∞—é—Ç—å –æ—á–∏—Å—Ç–∏—Ç–∏—Å—è
6. –í—ñ–¥–∫—Ä–∏—Ç–∏ –∑–Ω–æ–≤—É - storage –º–∞—î –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ storage

```javascript
// –í –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞
const stats = await getStorageStats();
console.log(stats);
// { count: 5, totalSize: 12400000, formattedSize: "12.4MB" }
```

### –û—á–∏—Å—Ç–∏—Ç–∏ storage

```javascript
// –í –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞
await clearAllImages();
console.log('–û—á–∏—â–µ–Ω–æ!');
```

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

### –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –±—Ä–∞—É–∑–µ—Ä—ñ–≤

- ‚úÖ Chrome, Edge, Firefox, Safari
- ‚úÖ iOS Safari, Chrome Mobile
- ‚ùå IE11 (–Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è)

### –ë–µ–∑–ø–µ–∫–∞

- IndexedDB –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π –¥–æ origin (—è–∫ localStorage)
- –î–∞–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –û—á–∏—â–∞—é—Ç—å—Å—è –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω—ñ –±—Ä–∞—É–∑–µ—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—á–∏—â–∞—é—Ç—å—Å—è –ø—Ä–∏ –≤–∏—Ö–æ–¥—ñ –∑ canvas

### –û–±–º–µ–∂–µ–Ω–Ω—è

- Blob URLs –ø–æ—Ç—Ä—ñ–±–Ω–æ revoke –¥–ª—è –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è –ø–∞–º'—è—Ç—ñ
- IndexedDB –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π (–ø–æ—Ç—Ä—ñ–±–µ–Ω await)
- –ù–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –º—ñ–∂ –≤–∫–ª–∞–¥–∫–∞–º–∏ –ª–µ–≥–∫–æ

### –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π cleanup Blob URLs**: –í—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ —Ç–∞ revoke –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ URLs
2. **–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è thumbnails**: –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –º–∞–ª–µ–Ω—å–∫—ñ preview
3. **Background sync**: –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ –∑ Supabase —É —Ñ–æ–Ω—ñ
4. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ quota**: –ü–æ–ø–µ—Ä–µ–¥–∂–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–µ—Ä–µ–¥ –ª—ñ–º—ñ—Ç–æ–º
5. **–û–ø—Ü—ñ—ó —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è**: –î–æ–∑–≤–æ–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –≤–∏–±–∏—Ä–∞—Ç–∏ —è–∫—ñ—Å—Ç—å

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ —Ç–∞ –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ  
**–î–∞—Ç–∞**: 2 –∂–æ–≤—Ç–Ω—è 2025  
**–í–µ—Ä—Å—ñ—è**: 1.0.0  
**Breaking Changes**: –ù–µ–º–∞—î (–∑–≤–æ—Ä–æ—Ç–Ω–æ —Å—É–º—ñ—Å–Ω–æ)

