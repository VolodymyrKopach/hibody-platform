# –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —ñ–Ω—Ç–µ–Ω—Ç—É "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω"

## –ü—Ä–æ–±–ª–µ–º–∞
–°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–ª–∞ –∑–∞–ø–∏—Ç–∏ —Ç–∏–ø—É "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω" —è–∫ `improve_html` –∑–∞–º—ñ—Å—Ç—å `edit_plan`, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏–ª–æ –¥–æ –ø–æ–º–∏–ª–∫–∏:

```
‚ùå No handler found for intent: improve_html
üí• Chat service error: Error: No handler found for intent: improve_html
```

## –ü—Ä–∏—á–∏–Ω–∞
Claude Haiku –ø–ª—É—Ç–∞–≤ "–ø–æ–∫—Ä–∞—â–∏—Ç–∏ –ø–ª–∞–Ω —É—Ä–æ–∫—É" –∑ "–ø–æ–∫—Ä–∞—â–∏—Ç–∏ HTML –∫–æ–¥" —á–µ—Ä–µ–∑ –Ω–µ—Ç–æ—á–Ω—ñ –æ–ø–∏—Å–∏ —ñ–Ω—Ç–µ–Ω—Ç—ñ–≤ —É –ø—Ä–æ–º–ø—Ç—ñ.

## –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

### 1. –î–æ–¥–∞–Ω–æ –Ω–æ–≤–∏–π —ñ–Ω—Ç–µ–Ω—Ç EDIT_PLAN
**–§–∞–π–ª:** `src/services/intent/IIntentDetectionService.ts`

```typescript
export enum UserIntent {
  // ... —ñ—Å–Ω—É—é—á—ñ —ñ–Ω—Ç–µ–Ω—Ç–∏
  EDIT_PLAN = 'edit_plan',     // ‚Üê –ù–û–í–ò–ô –Ü–ù–¢–ï–ù–¢
  // ... —ñ–Ω—à—ñ —ñ–Ω—Ç–µ–Ω—Ç–∏
}
```

### 2. –ü–æ–∫—Ä–∞—â–µ–Ω–æ –ø—Ä–æ–º–ø—Ç Claude Haiku
**–§–∞–π–ª:** `src/services/intent/ClaudeHaikuIntentService.ts`

–î–æ–¥–∞–Ω–æ —á—ñ—Ç–∫—ñ –æ–ø–∏—Å–∏ —ñ–Ω—Ç–µ–Ω—Ç—ñ–≤:
```
- EDIT_PLAN: –∑–º—ñ–Ω–∏—Ç–∏/–ø–æ–∫—Ä–∞—â–∏—Ç–∏ –ø–ª–∞–Ω —É—Ä–æ–∫—É (—Ñ—Ä–∞–∑–∏: "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω", "–∑–º—ñ–Ω –ø–ª–∞–Ω", "–æ–Ω–æ–≤–∏—Ç–∏ –ø–ª–∞–Ω")
- EDIT_HTML_INLINE: —Ç–µ–∫—Å—Ç–æ–≤—ñ –∑–º—ñ–Ω–∏ –≤ HTML
- IMPROVE_HTML: –∑–∞–≥–∞–ª—å–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è HTML –∫–æ–¥—É
```

–î–æ–¥–∞–Ω–æ –ø—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:
```json
–î–ª—è "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω":
{
  "intent": "EDIT_PLAN",
  "confidence": 0.9,
  "parameters": {
    "topic": null,
    "age": null,
    "slideNumber": null
  },
  "language": "uk",
  "reasoning": "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ö–æ—á–µ –∑–º—ñ–Ω–∏—Ç–∏ –ø–ª–∞–Ω —É—Ä–æ–∫—É",
  "isDataSufficient": true,
  "missingData": [],
  "suggestedQuestion": null
}
```

### 3. –û–Ω–æ–≤–ª–µ–Ω–æ EditPlanHandler
**–§–∞–π–ª:** `src/services/chat/handlers/EditPlanHandler.ts`

**–ü–æ–∫—Ä–∞—â–µ–Ω–æ `canHandle()`:**
```typescript
canHandle(intent: IntentDetectionResult, conversationHistory?: ConversationHistory): boolean {
  return intent.intent === UserIntent.EDIT_PLAN || 
         conversationHistory?.step === 'plan_editing';
}
```

**–î–æ–¥–∞–Ω–æ –æ–±—Ä–æ–±–∫—É –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:**
```typescript
// Handle case when user wants to edit plan but no conversation history exists
if (!conversationHistory || !conversationHistory.planningResult) {
  return {
    success: true,
    message: `ü§î –°—Ö–æ–∂–µ, –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –ø–ª–∞–Ω —É—Ä–æ–∫—É, –∞–ª–µ –Ω–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–ª–∞–Ω—É.

üí° **–î–∞–≤–∞–π—Ç–µ —Å—Ç–≤–æ—Ä–∏–º–æ –Ω–æ–≤–∏–π –ø–ª–∞–Ω!** –°–∫–∞–∂—ñ—Ç—å –º–µ–Ω—ñ:
‚Ä¢ –ü—Ä–æ —â–æ –º–∞—î –±—É—Ç–∏ —É—Ä–æ–∫? (—Ç–µ–º–∞)
‚Ä¢ –î–ª—è —è–∫–æ–≥–æ –≤—ñ–∫—É –¥—ñ—Ç–µ–π? (–≤—ñ–∫)

**–ü—Ä–∏–∫–ª–∞–¥:** "–°—Ç–≤–æ—Ä–∏ —É—Ä–æ–∫ –ø—Ä–æ –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤ –¥–ª—è –¥—ñ—Ç–µ–π 6 —Ä–æ–∫—ñ–≤"`,
    conversationHistory: undefined,
    actions: []
  };
}
```

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —Ñ—Ä–∞–∑–∏:
‚úÖ "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω"
‚úÖ "–∑–º—ñ–Ω—ñ—Ç—å –ø–ª–∞–Ω" 
‚úÖ "–æ–Ω–æ–≤–∏—Ç–∏ –ø–ª–∞–Ω"
‚úÖ "edit plan" (–∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é)

### –°—Ü–µ–Ω–∞—Ä—ñ—ó:
1. **–ë–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–ª–∞–Ω—É:**
   - –í—Ö—ñ–¥: "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω"
   - –í–∏—Ö—ñ–¥: –ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–ª–∞–Ω

2. **–ó –∞–∫—Ç–∏–≤–Ω–∏–º –ø–ª–∞–Ω–æ–º:** 
   - –í—Ö—ñ–¥: "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω" + conversation history
   - –í–∏—Ö—ñ–¥: –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ –ø–ª–∞–Ω—É

### –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```bash
curl -X POST http://localhost:3002/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω"}'

# –£—Å–ø—ñ—à–Ω–æ: –ø–æ–≤–µ—Ä—Ç–∞—î –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–ª–∞–Ω
```

## –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏

### –î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
- ‚ùå "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω" ‚Üí `improve_html` ‚Üí –ø–æ–º–∏–ª–∫–∞
- ‚ùå –ü–ª—É—Ç–∞–Ω–∏–Ω–∞ –º—ñ–∂ —ñ–Ω—Ç–µ–Ω—Ç–∞–º–∏

### –ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
- ‚úÖ "–ø–æ–∫—Ä–∞—â –ø–ª–∞–Ω" ‚Üí `edit_plan` ‚Üí –∫–æ—Ä–µ–∫—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞
- ‚úÖ –ß—ñ—Ç–∫–µ —Ä–æ–∑—Ä—ñ–∑–Ω–µ–Ω–Ω—è —ñ–Ω—Ç–µ–Ω—Ç—ñ–≤
- ‚úÖ –Ü–Ω—Ç–µ–ª—ñ–≥–µ–Ω—Ç–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

## –Ü–Ω—à—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É

–î–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è:

1. **–î–æ–¥–∞—Ç–∏ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ:** –ë—ñ–ª—å—à–µ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ —Ñ—Ä–∞–∑ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —ñ–Ω—Ç–µ–Ω—Ç—É
2. **A/B —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ —è–∫—ñ—Å—Ç—å —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö –≤–µ—Ä—Å—ñ–π –ø—Ä–æ–º–ø—Ç—ñ–≤
3. **–õ–æ–≥—É–≤–∞–Ω–Ω—è:** –í—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–Ω—ñ —ñ–Ω—Ç–µ–Ω—Ç–∏
4. **–§—ñ–¥–±–µ–∫ —Å–∏—Å—Ç–µ–º–∞:** –î–æ–∑–≤–æ–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –≤–∏–ø—Ä–∞–≤–ª—è—Ç–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ —ñ–Ω—Ç–µ–Ω—Ç–∏

## –í–∏—Å–Ω–æ–≤–æ–∫

‚úÖ **–ü—Ä–æ–±–ª–µ–º—É –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏—Ä—ñ—à–µ–Ω–æ.** –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞—î –∑–∞–ø–∏—Ç–∏ –Ω–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø–ª–∞–Ω—É —Ç–∞ –Ω–∞–¥–∞—î –∫–æ—Ä–∏—Å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞–≤—ñ—Ç—å –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É. 