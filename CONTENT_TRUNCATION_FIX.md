# –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–∏ –∑ –æ–±—Ä—ñ–∑–∫–æ—é –∫–æ–Ω—Ç–µ–Ω—Ç—É

## –ü—Ä–æ–±–ª–µ–º–∞
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤—ñ–¥–æ–º–∏–≤, —â–æ –ø–ª–∞–Ω —É—Ä–æ–∫—É –æ–±—Ä—ñ–∑–∞—î—Ç—å—Å—è —ñ –Ω–µ –ø–æ–∫–∞–∑—É—î –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç:

```
–ü–ª–∞–Ω —É—Ä–æ–∫—É "–î–∏–≤–æ–≤–∏–∂–Ω–∏–π —Å–≤—ñ—Ç –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤"
–ú–µ—Ç–∞ —É—Ä–æ–∫—É: –ü–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏ –¥—ñ—Ç–µ–π –∑ –æ—Å–Ω–æ–≤–Ω–∏–º–∏ –≤–∏–¥–∞–º–∏ –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤...
[–∫–æ–Ω—Ç–µ–Ω—Ç –æ–±—Ä–∏–≤–∞—î—Ç—å—Å—è]
```

## –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ API –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
```bash
curl -X POST http://localhost:3001/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "—Å—Ç–≤–æ—Ä–∏ —É—Ä–æ–∫ –ø—Ä–æ –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤ –¥–ª—è –¥—ñ—Ç–µ–π 6 —Ä–æ–∫—ñ–≤"}'
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: API –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç (3600+ —Å–∏–º–≤–æ–ª—ñ–≤).

### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–±–º–µ–∂–µ–Ω—å —Ç–æ–∫–µ–Ω—ñ–≤
**–ü—Ä–æ–±–ª–µ–º–∞ –∑–Ω–∞–π–¥–µ–Ω–∞:** –£ `ClaudeSonnetContentService.ts` –±—É–ª–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –æ–±–º–µ–∂–µ–Ω–Ω—è `max_tokens: 4000`, —â–æ –±—É–ª–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è –ø–æ–≤–Ω–∏—Ö –ø–ª–∞–Ω—ñ–≤ —É—Ä–æ–∫—ñ–≤.

### 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É
- `ChatMessage.tsx` - –Ω–µ–º–∞—î CSS –æ–±–º–µ–∂–µ–Ω—å
- `MarkdownRenderer.tsx` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—î –¥–æ–≤–≥–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
- `useChatLogic.ts` - –ø–µ—Ä–µ–¥–∞—î –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑ –æ–±—Ä—ñ–∑–∫–∏

## –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

### 1. –ó–±—ñ–ª—å—à–µ–Ω–æ –ª—ñ–º—ñ—Ç —Ç–æ–∫–µ–Ω—ñ–≤ Claude Sonnet
**–§–∞–π–ª:** `src/services/content/ClaudeSonnetContentService.ts`

```typescript
// ‚ùå –ë—É–ª–æ
max_tokens: 4000,

// ‚úÖ –°—Ç–∞–ª–æ
max_tokens: 8000,
```

### 2. –î–æ–¥–∞–Ω–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
```typescript
console.log(`üìè Generated lesson plan length: ${content.length} characters`);
console.log(`üìä Response usage:`, data.usage);

// Check if content was truncated
if (data.usage?.output_tokens >= 7900) {
  console.warn('‚ö†Ô∏è Content might be truncated due to token limit');
}

// Check for common truncation indicators
if (content.includes('[TRUNCATED]') || content.includes('...') && content.length > 3000) {
  console.warn('‚ö†Ô∏è Content appears to be truncated');
}
```

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ç–µ—Å—Ç
–°—Ç–≤–æ—Ä–µ–Ω–æ —Ñ–∞–π–ª `test-full-content.html` –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:
```bash
open test-full-content.html
```

### –†—É—á–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ http://localhost:3001/chat
2. –ù–∞–ø–∏—Å–∞—Ç–∏: "—Å—Ç–≤–æ—Ä–∏ —É—Ä–æ–∫ –ø—Ä–æ –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤ –¥–ª—è –¥—ñ—Ç–µ–π 6 —Ä–æ–∫—ñ–≤"
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –ø–ª–∞–Ω –º—ñ—Å—Ç–∏—Ç—å –≤—Å—ñ —Å–µ–∫—Ü—ñ—ó:
   - –°–ª–∞–π–¥–∏ 1-6
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –≤–∏–∫–ª–∞–¥–∞–Ω–Ω—è
   - –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏
   - –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–ü—Ä–æ–±–ª–µ–º—É –≤–∏—Ä—ñ—à–µ–Ω–æ:** –¢–µ–ø–µ—Ä –ø–ª–∞–Ω–∏ —É—Ä–æ–∫—ñ–≤ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –ø–æ–≤–Ω—ñ—Å—Ç—é –±–µ–∑ –æ–±—Ä—ñ–∑–∫–∏.

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:
- **–ë—É–ª–æ:** ~1500-2000 —Å–∏–º–≤–æ–ª—ñ–≤ (–æ–±—Ä—ñ–∑–∞–Ω–æ)
- **–°—Ç–∞–ª–æ:** ~3600+ —Å–∏–º–≤–æ–ª—ñ–≤ (–ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç)
- **–¢–æ–∫–µ–Ω–∏:** –ó 4000 –¥–æ 8000 (–ø–æ–¥–≤–æ—î–Ω–æ)

### –ü—Ä–∏–∫–ª–∞–¥ –ø–æ–≤–Ω–æ–≥–æ –ø–ª–∞–Ω—É:
```
# –ü–ª–∞–Ω —É—Ä–æ–∫—É "–î–∏–≤–æ–≤–∏–∂–Ω–∏–π —Å–≤—ñ—Ç –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤"

**–ú–µ—Ç–∞ —É—Ä–æ–∫—É:** –ü–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏ –¥—ñ—Ç–µ–π –∑ –æ—Å–Ω–æ–≤–Ω–∏–º–∏ –≤–∏–¥–∞–º–∏ –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤...
**–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å:** 30 —Ö–≤–∏–ª–∏–Ω

## –°–ª–∞–π–¥ 1: "–ü–æ–¥–æ—Ä–æ–∂ —É —Å–≤—ñ—Ç –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤" (–í—Å—Ç—É–ø–Ω–∏–π)
...
## –°–ª–∞–π–¥ 6: "–ú–∞–ª–µ–Ω—å–∫—ñ –ø–∞–ª–µ–æ–Ω—Ç–æ–ª–æ–≥–∏" (–ü—Ä–∞–∫—Ç–∏–∫–∞)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –≤–∏–∫–ª–∞–¥–∞–Ω–Ω—è:
1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —è—Å–∫—Ä–∞–≤—ñ –Ω–∞–æ—á–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏
...

## –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏:
- –ö–∞—Ä—Ç–∫–∏ –∑ –¥–∏–Ω–æ–∑–∞–≤—Ä–∞–º–∏
...

## –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:
- –î—ñ—Ç–∏ –∑–Ω–∞—Ç–∏–º—É—Ç—å –æ—Å–Ω–æ–≤–Ω—ñ –≤–∏–¥–∏ –¥–∏–Ω–æ–∑–∞–≤—Ä—ñ–≤
...
```

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

–î–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
npm run dev | grep "Generated lesson plan length"
```

–Ø–∫—â–æ –¥–æ–≤–∂–∏–Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç—É –Ω–∞–±–ª–∏–∂–∞—î—Ç—å—Å—è –¥–æ 7500+ —Å–∏–º–≤–æ–ª—ñ–≤, —Ä–æ–∑–≥–ª—è–Ω—å—Ç–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è `max_tokens` –¥–æ 10000. 